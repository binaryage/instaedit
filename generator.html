---
layout: default
title: Instaedit code generator
---

<script>
	function minify(code) {
		return code.replace(/(\r\n|\n|\r|\t)/gm, "");code;
	}

	function hideScriptFields() {
		var tbl = document.getElementById('scripts');
		tbl.style.visibility = 'hidden';
	}

	function showScriptFields() {
		var tbl = document.getElementById('scripts');
		tbl.style.visibility = 'visible';
	}

	function composeCode(workerLocation, parserLocation) {
		var code = document.getElementById('code-source');
		
		code.style.visibility = 'hidden';

		code = code.innerHTML;
		code = code.replace('~worker~', workerLocation);
		code = code.replace('~parser~', parserLocation);

		return code;
	}

	function copyToClipboard(text) {
  		var input = document.getElementById('code');
  		
  		input.select();

  		document.execCommand('Copy');
	}

	window.onload = function () {
		code.innerHTML = composeCode('./js/parser-example.js', '../src/instaedit-worker.js');
		hideScriptFields();

		var ownRadio = document.getElementById('own');
		var githubRadio = document.getElementById('github');
		var defaultRadio = document.getElementById('default');
		var minifyButton = document.getElementById('minify');
		var clipboardButton = document.getElementById('clipboard');

		ownRadio.onclick = function () {
			code.innerHTML = composeCode('path/to/parser.js', 'path/to/worker.js');
			showScriptFields();
		}

		defaultRadio.onclick = function () {
			hideScriptFields();

			var code = document.getElementById('code');
			code.innerHTML = composeCode('./js/parser-example.js', '../src/instaedit-worker.js');
		}

		githubRadio.onclick = function () {
			hideScriptFields();

			var code = document.getElementById('code');
			code.innerHTML = composeCode('https://raw.github.com/binaryage/instaedit/master/demo/js/parser-example.js', 'https://raw.github.com/binaryage/instaedit/master/src/instaedit-worker.js');
		}

		minifyButton.onclick = function () {
			var code = document.getElementById('code');
			code.innerHTML = minify(code.innerHTML);
		}

		clipboardButton.onclick = function () {
			var code = document.getElementById('code').innerHTML;
			alert(code);
		}
	}

	addEventListener('keydown', function () {
		var code = document.getElementById('code');
		code.innerHTML = composeCode(document.generator.worker.value, document.generator.parser.value);

		console.log(document.generator.worker.value);
		console.log(document.generator.parser.value);
	});
</script>

<style>
	body {
		background: url(http://subtlepatterns.com/patterns/purty_wood.png);
	}

	#bg-shield-1 {
		width: 35%;

		width: fixed;
		height: 220px;

		position: absolute;
		left: 10%;
		top: 190px;
		opacity: 0.2;
	}

	#bg-shield-2 {
		width: 45%;

		width: fixed;
		height: 420px;

		position: absolute;
		left: 45%;
		top: 110px;
		opacity: 0.5;
	}

	.bg-shield {
		background-color: black;
		
		box-shadow: -1px -1px 10px grey;

		border-top-left-radius: 4px;
		border-bottom-left-radius: 4px;

		border-color: #e5e5e5;
	}

	#form {
		width: 45%;

		position: absolute;
		left: 10%;
		top: 190px;

		padding: 20px 20px 20px 20px;
		font-family: "Helvetica";
	}

	#code {
		width: 40%;
		padding: 5px 25px 20px 15px;
		
		word-wrap: break-word;

		border-top-right-radius: 10px;
		border-bottom-right-radius: 10px;
		border-bottom-left-radius: 10px;

		position: absolute;
		left: 45%;
		top: 100px;

		color: white;
	}

	input[type=text] {
		width: 250px;
		height: 25px;
		border-radius: 5px;
		border: 1px solid grey;
	}

	#minify {

	}

	.button {
		background-image: -webkit-linear-gradient(top, #08C, #05C);
		position: relative;
		
		padding: 5px 5px 5px 5px;
		border-radius: 5px;
		cursor: pointer;
		
		font-family: "Arial";
		font-size: 15px;
		border-color: #CCC;

		color: #fff;

		text-align: center;

		padding: 5px 20px 5px 20px;
		margin-right: 5px;
	}

	h1 {
		font-family: "HelveticaNeue";
		opacity: 0.5;
		text-shadow: -1px -1px 2px grey;
		text-align: center;
	}
</style>

<div class="bg-shield" id="bg-shield-1"></div>

<div id="form">
	<form name="generator">
		<table>
			<tr> <td> <input type="radio" name="source-type" value="github" id="github"/> </td><td> Instaedit Github </td> <tr>
			<tr> <td> <input type="radio" name="source-type" value="default" id="default" checked="checked" /> </td><td> Instaedit default </td> <tr>
			<tr> <td> <input type="radio" name="source-type" value="own" id="own"/> </td><td> Your own </td> <tr>
		</table>

		<table id="scripts">
			<tr> <td> Parser </td> <td> <input type="text" name="parser" value="./js/parser-example.js"> </td> </tr>
			<tr> <td> Worker </td> <td> <input type="text" name="worker" value="../src/instaedit-worker.js"> </td> </tr>
		</table>

		<br>
		<span class="button" id="minify">Minify</span>
		<span class="button" id="clipboard">Copy to clipboard</span>
	</form>
</div>

<div class="bg-shield" id="bg-shield-2"></div>

<pre id="code"></pre>

<div id="code-source">var instaeditLoaded = false;

window.onload = function () {
	var button = document.getElementById('instaedit-edit');

	button.onclick = function () {
		loadScripts(~parser~);
	}
}

function loadScripts(parserScript) {
	addJavascript(~worker~);
	addJavascript(parserScript);
}

function addJavascript(name) {
	var th = document.getElementsByTagName('head')[0];
	var s = document.createElement('script');
	s.setAttribute('type', 'text/javascript');

	var id = new Date().getTime();
	s.setAttribute('src', name + '?id' + id);

	th.appendChild(s);
}";
</div>

<input type="text" id="helper" style="visibility: hidden;">